// =======================================
// Results Page - Header & Content Section
// 헤더, 다이어그램, 콘텐츠 영역 및 유틸리티
// =======================================

@use "../../import/_mixin" as *;
@use "variables" as *;

.results {
  // ---------------------------------------
  // Sub Header Section
  // ---------------------------------------
  .sub-header {
    background-image: $results-bg-title;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    
    @include mq(tablet-small, max) {
      background-position: center top;
    }
  }

  // ---------------------------------------
  // Sub Content Section
  // ---------------------------------------
  .sub-content {
    flex-direction: column;
    gap: $results-section-gap;
    margin: 0 auto;
    padding-bottom: 250px;
    text-align: center;
    @include flex(center, center);
    @include mq(tablet-wide, max) {
      padding-bottom: 180px;
    }
    
    // 워터마크 텍스트
    &::before {
      content: "Exploration\A Results";
      text-align: left;
      line-height: 0.8em;
      letter-spacing: -0.04em;
      @include mq(tablet-wide, max) {
        bottom: 20px;
        text-align: right;
        left: auto;
        right: 1.4rem;
      }
    }

    // ---------------------------------------
    // Diagram Wrapper
    // ---------------------------------------
    .condition {
      padding: $results-padding-y 0;
      width: 100%;
      max-width: 100%;
      overflow: hidden;
    }

    // ---------------------------------------
    // Diagram Circles (원형 다이어그램)
    // ---------------------------------------
    .dia-circles-wrap {
      .circle-belt {
        background: $results-belt;
        border: 1px solid $results-dash;
      }

      .circle-dash {
        border: 1px dashed $results-dash;
      }

      // 점선 애니메이션
      .circle-dots {
        &.move {
          .dot {
            background: $results-dot;
            &:nth-child(2) {
              top: 100%;
              left: calc(50% - 4px);
              transform: translateY(-50%);
            }
          }
        }
        
        .dot {
          background: $results-dot;
          $dot-positions: (
            1: (top: 0%, left: calc(50% - 4px), transform: translateY(-50%)),
            2: (top: 75%, left: 5.5%, transform: translateY(-50%) rotate(120deg)),
            3: (top: 75%, right: 5.5%, transform: translateY(-50%) rotate(240deg)),
            4: (bottom: -8px, left: calc(50% - 4px), transform: translateY(-50%)),
            5: (top: 25%, left: 5.5%, transform: translateY(-50%) rotate(120deg)),
            6: (top: 25%, right: 5.5%, transform: translateY(-50%) rotate(240deg)),
          );
          @each $n, $props in $dot-positions {
            &:nth-child(#{$n}) {
              @each $k, $v in $props {
                #{$k}: $v;
              }
            }
          }
        }

        &.move {
          animation-name: dot-rotate3;
        }
      }

      // 중앙 원형 코어
      .circle-core {
        position: relative;
        line-height: 95%;
        &::before {
          content: "";
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          box-sizing: border-box;
          background: linear-gradient(180deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 100%);
          @include maskContents();
          padding: 4px;
        }
        
      }

      // 원형 배치 요소 링 (6개 항목)
      .dia-element-ring {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        z-index: 2;
        pointer-events: none;

        .dia-element {
          position: absolute;
          left: 0;
          top: 0;
          transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-#{$results-diagram-base-radius}) rotate(calc(-1 * var(--angle, 0deg)));
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 8px;
          pointer-events: auto;

          @include mq(tablet-small, max) {
            transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-170px) rotate(calc(-1 * var(--angle, 0deg)));
          }
          @include mq(phone-wide, max) {
            transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-140px) rotate(calc(-1 * var(--angle, 0deg)));
            gap: 0;
          }

          .dia-tit {
            font-size: 16px;
            white-space: nowrap;
            flex-direction: column;
            gap: 8px;
            @include flex(center, center);
          }

          i {
            aspect-ratio: 1 / 1;
            background-position: center;
            background-size: contain;
            background-repeat: no-repeat;
          }

          // 점선 연결선
          .dot {
            width: 0;
            height: 32px;
            border-left: 1px dashed $results-dot;
            position: relative;
            flex-shrink: 0;
            transform: rotate(var(--angle, 0deg));
            transform-origin: center top;
          }
          @include mq(phone-wide, max) {
            &.dia-pos-1 {
              gap: 4px;
            }
          }
          // 위치별 스타일 조정
          &.dia-pos-2 {
            margin-left: 24px;
            flex-direction: row-reverse;
            @include mq(phone-wide, max) {
              margin-left: 6px;
            }
            .dia-tit {
              flex-direction: row;
            }
            .dot {
              top: 24px;
              @include mq(phone-wide, max) {
                top: 20px;
              }
            }
          }
          
          &.dia-pos-3 {
            margin-left: 44px;
            flex-direction: row-reverse;
            @include mq(phone-wide, max) {
              margin-left: 20px;
            }
            .dia-tit {
              flex-direction: row;
            }
            .dot {
              top: 10px;
              @include mq(phone-wide, max) {
                top: 12px;
              }
            }
          }
          
          &.dia-pos-4 {
            flex-direction: column-reverse;
            @include mq(phone-wide, max) {
              gap: 4px;
            }
            .dot {
              transform: rotate(0);
            }
          }
          
          &.dia-pos-5 {
            margin-left: -50px;
            flex-direction: row;
            @include mq(phone-wide, max) {
              margin-left: -24px;
            }
            .dia-tit {
              flex-direction: row;
            }
            .dot {
              top: 10px;
              @include mq(phone-wide, max) {
                top: 12px;
              }
            }
          }
          
          &.dia-pos-6 {
            margin-left: -30px;
            flex-direction: row;
            @include mq(phone-wide, max) {
              margin-left: -8px;
            }
            .dia-tit {
              flex-direction: row-reverse;
            }
            .dot {
              top: 22px;
              @include mq(phone-wide, max) {
                top: 20px;
              }
            }

          }
          &.dia-pos-2,
          &.dia-pos-3 ,
          &.dia-pos-5,
          &.dia-pos-6 {
            .dia-tit {
              @include mq(phone-wide, max) {
                flex-direction: column;
                gap: 4px;
              }
            }
          }
          
          // 아이콘 스타일 (토지, 인구, 기반시설, 도시&주거, 생태&자연, 기상)
          &.dia-pos-1 i { 
            width: 26px; 
            background-image: url(../img/results/ico_map.svg); 
          }
          &.dia-pos-2 i { 
            width: 30px; 
            background-image: url(../img/results/ico_people.svg); 
          }
          &.dia-pos-3 i { 
            width: 32px; 
            background-image: url(../img/results/ico_facility.svg); 
          }
          &.dia-pos-4 i { 
            width: 25px; 
            background-image: url(../img/results/ico_city.svg); 
          }
          &.dia-pos-5 i { 
            width: 36px; 
            background-image: url(../img/results/ico_eco.svg); 
          }
          &.dia-pos-6 i { 
            width: 33px; 
            background-image: url(../img/results/ico_weather.svg); 
          }
        }
      }
    }
  }
}

// =======================================
// Utility Classes
// =======================================

// 반응형 텍스트 줄바꿈 처리
.txt-line {
  display: block;
  
  @include mq(tablet-small, max) {
    display: inline;
    & + .txt-line::before {
      content: ' ';
    }
  }
}

.results {
  .sub-header .sub-txt .txt-line,
  .sub-content .sub-tit-box .sub-tit .txt-line {
    @include mq(tablet-small, max) {
      display: block;
    }
  }
}
