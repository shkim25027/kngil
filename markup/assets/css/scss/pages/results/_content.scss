// ============================================================
// results — 상단 헤더·다이어그램·콘텐츠 영역
// ============================================================
// 담당: .sub-header, .sub-content, .condition, .dia-circles-wrap
// 다이어그램 6개 항목: 토지(1), 인구(2), 기반시설(3), 도시&주거(4), 생태&자연(5), 기상(6)
// ============================================================

@use "../../import/_mixin" as *;
@use "variables" as *;

// ---------------------------------------
// 다이어그램용 데이터 (한곳에서 수정)
// ---------------------------------------
$dia-dot-positions: (
  1: (top: 0%, left: calc(50% - 4px), transform: translateY(-50%)),
  2: (top: 75%, left: 5.5%, transform: translateY(-50%) rotate(120deg)),
  3: (top: 75%, right: 5.5%, transform: translateY(-50%) rotate(240deg)),
  4: (bottom: -8px, left: calc(50% - 4px), transform: translateY(-50%)),
  5: (top: 25%, left: 5.5%, transform: translateY(-50%) rotate(120deg)),
  6: (top: 25%, right: 5.5%, transform: translateY(-50%) rotate(240deg)),
);

$dia-icon-config: (
  1: (size: 26px, img: url(../img/results/ico_map.svg)),      // 토지
  2: (size: 30px, img: url(../img/results/ico_people.svg)),   // 인구
  3: (size: 32px, img: url(../img/results/ico_facility.svg)), // 기반시설
  4: (size: 25px, img: url(../img/results/ico_city.svg)),     // 도시&주거
  5: (size: 36px, img: url(../img/results/ico_eco.svg)),       // 생태&자연
  6: (size: 33px, img: url(../img/results/ico_weather.svg)),   // 기상
);

// ============================================================
// .results 컨테이너 (성과품 페이지 루트)
// ============================================================

.results {

  // ---------------------------------------
  // 상단 헤더 (.sub-header) — 배경 이미지
  // ---------------------------------------
  .sub-header {
    background-image: $results-bg-title;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    @include mq(tablet-small, max) {
      background-position: center top;
    }
  }

  // ---------------------------------------
  // 서브 콘텐츠 (.sub-content)
  // z-index, margin-bottom는 _pin-overlap.scss에서 설정
  // ---------------------------------------
  .sub-content {
    &::before {
      content: "Exploration\A Results";
    }

    // ---------------------------------------
    // 원형 다이어그램 (.dia-circles-wrap)
    // ---------------------------------------
    .dia-circles-wrap {

      // 벨트(채워진 원)
      .circle-belt {
        background: $results-belt;
        border: 1px solid $results-dash;
      }

      // 점선 원
      .circle-dash {
        border: 1px dashed $results-dash;
      }

      // 점선 위의 점들 (위치 + 애니메이션)
      .circle-dots {
        &.move {
          .dot {
            background: $results-dot;
            &:nth-child(2) {
              top: 100%;
              left: calc(50% - 4px);
              transform: translateY(-50%);
            }
          }
        }

        .dot {
          background: $results-dot;
          @each $n, $props in $dia-dot-positions {
            &:nth-child(#{$n}) {
              @each $k, $v in $props {
                #{$k}: $v;
              }
            }
          }
        }

        &.move {
          animation-name: dot-rotate3;
        }
      }

      // 중앙 코어 ("고품질의 성과품" 텍스트)
      .circle-core {
        &::before {
          content: "";
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          box-sizing: border-box;
          background: linear-gradient(180deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 100%);
          @include maskContents();
          padding: 4px;
        }
        span {
          line-height: 1.2;
        }
      }

      // ---------------------------------------
      // 6개 항목 링 (.dia-element-ring, .dia-element)
      // ---------------------------------------
      .dia-element-ring {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        z-index: 2;
        pointer-events: none;

        .dia-element {
          position: absolute;
          left: 0;
          top: 0;
          transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-#{$results-diagram-base-radius}) rotate(calc(-1 * var(--angle, 0deg)));
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 8px;
          pointer-events: auto;

          @include mq(tablet-small, max) {
            transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-170px) rotate(calc(-1 * var(--angle, 0deg)));
          }
          @include mq(phone-wide, max) {
            transform: translate(-50%, -50%) rotate(var(--angle, 0deg)) translateY(-140px) rotate(calc(-1 * var(--angle, 0deg)));
            gap: 0;
          }

          .dia-tit {
            font-size: 16px;
          }

          i {
            aspect-ratio: 1 / 1;
            background-position: center;
            background-size: contain;
            background-repeat: no-repeat;
          }

          // 점선 연결선 (중앙 → 라벨)
          .dot {
            width: 0;
            height: 32px;
            border-left: 1px dashed $results-dot;
            position: relative;
            flex-shrink: 0;
            transform: rotate(var(--angle, 0deg));
            transform-origin: center top;
          }

          @include mq(phone-wide, max) {
            &.dia-pos-1 {
              gap: 4px;
            }
          }

          // --- 위치별 레이아웃·연결선 조정 (pos 1~6) ---
          &.dia-pos-2 {  // 인구
            margin-left: 24px;
            flex-direction: row-reverse;
            @include mq(phone-wide, max) { margin-left: 6px; }
            .dia-tit { flex-direction: row; }
            .dot {
              top: 24px;
              @include mq(phone-wide, max) { top: 20px; }
            }
          }

          &.dia-pos-3 {  // 기반시설
            margin-left: 44px;
            flex-direction: row-reverse;
            @include mq(phone-wide, max) { margin-left: 20px; }
            .dia-tit { flex-direction: row; }
            .dot {
              top: 10px;
              @include mq(phone-wide, max) { top: 12px; }
            }
          }

          &.dia-pos-4 {  // 도시&주거
            flex-direction: column-reverse;
            @include mq(phone-wide, max) { gap: 4px; }
            .dot { transform: rotate(0); }
          }

          &.dia-pos-5 {  // 생태&자연
            margin-left: -50px;
            flex-direction: row;
            @include mq(phone-wide, max) { margin-left: -24px; }
            .dia-tit { flex-direction: row-reverse; }
            .dot {
              top: 10px;
              @include mq(phone-wide, max) { top: 12px; }
            }
          }

          &.dia-pos-6 {  // 기상
            margin-left: -30px;
            flex-direction: row;
            @include mq(phone-wide, max) { margin-left: -8px; }
            .dia-tit { flex-direction: row-reverse; }
            .dot {
              top: 22px;
              @include mq(phone-wide, max) { top: 20px; }
            }
          }

          // 모바일에서 2,3,5,6 타이틀 세로 배치
          &.dia-pos-2,
          &.dia-pos-3,
          &.dia-pos-5,
          &.dia-pos-6 {
            .dia-tit {
              @include mq(phone-wide, max) {
                flex-direction: column;
                gap: 4px;
              }
            }
          }

          // 아이콘 크기·이미지 (맵 기반으로 자동 적용)
          @each $pos, $conf in $dia-icon-config {
            &.dia-pos-#{$pos} i {
              width: map-get($conf, size);
              background-image: map-get($conf, img);
            }
          }
        }
      }
    }
  }
}

// ============================================================
// 유틸리티 (페이지 공통)
// ============================================================

// 반응형에서 블록 → 인라인 줄바꿈
.txt-line {
  display: block;

  @include mq(tablet-small, max) {
    display: inline;
    & + .txt-line::before {
      content: ' ';
    }
  }
}

// results 페이지 내 .txt-line 은 모바일에서도 블록 유지
.results {
  .sub-header .sub-txt .txt-line,
  .sub-content .sub-tit-box .sub-tit .txt-line {
    @include mq(tablet-small, max) {
      display: block;
    }
  }
}
